# div4aep

Divide the earth's land mass into patches with prescribed maximum diameter along administrative boundaries and get optimal parameters for azimuthal equispaced projections.

Each patch of land generated by `div4aep`
* corresponds to exactly one relation in the [OpenStreetMap](https://openstreetmap.org) data base with tags `type=boundary` and `boundary=administrative`.
* has prescribed maximum diameter (distance between farthest points).
* comes with center and radius of the smallest enclosing circle.

All patches together cover (almost) all of the earth's land mass.

Based on `div4aep`'s data you may generate optimal azimuthal equispaced projections for each patch. Deviation of Euclidean distances in the projected maps from geodesic distances will be uniformly bounded with respect to all patches. For computation of the bound given maximum diameter (and vice verse) and for ready-to-use data sets produced by `div4aep` see [div4aep data sets](https://whz.de/~jef19jdw/codedata/div4aep.html).

## Installation

Clone this repo or download `div4aep.py` and `config.json.template` from this repo.

## Usage

Rename `config.json.template` to `config.json` and adapt config options to you needs. Non-self-explanatory options are:
* `overpass_key`: API key for your Overpass API instance.
* `bbox`: Only `admin_level=2` (and above) administrative boundaries lying (partially) inside this box will be considered.
* `max_admin_level`: Do not consider higher `admin_level` values.
* `min_coverage`: Discard a set of subpatches if it does not cover the parent patch to at least this fraction (0 = nocoverage, 1 = full coverage).
* `good_coverage`: Do not discard partial coverings if coverage is above this value.
* `max_overhang`: Consider a subpatch as contained in the parent patch if at most this fraction of the patch lies outside the parent patch (value 0-1).
* `patches_map_path`: Write a visualization of all patches to this file (HTML and JavaScript/Leaflet).
* `uncovered_map_path`: Write a visualization of uncovered areas of initial patches with subpatches not covering the whole parent patch to this file (HTML and JavaScript/Leaflet).

**IMPORTANT:** You should not use public Overpass API instances with `div4aep`! With default configuration `div4aep` will send about 120 queries with overall download size about 3 GB. If you would like to have a private Overpass API instance, have a look at [Overpass API Podman image](https://github.com/jeflem/overpass-podman).

If config options are set, run
```
python div4aep.py
```

## Contributing

Open a GitiHub issue for bug reports. File pull requests against the `dev` branch.

The `dev` branch contains the code for the next release, whereas the `main` branch holds the current release.

## Licence
[GNU General Public License v3.0](https://www.gnu.org/licenses/gpl-3.0.html.en)